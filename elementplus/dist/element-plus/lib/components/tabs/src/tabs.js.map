{"version":3,"file":"tabs.js","sources":["../../../../../../packages/components/tabs/src/tabs.tsx"],"sourcesContent":["import {\n  computed,\n  defineComponent,\n  getCurrentInstance,\n  provide,\n  reactive,\n  ref,\n  renderSlot,\n  watch,\n} from 'vue'\nimport {\n  buildProps,\n  definePropType,\n  isFunction,\n  isNumber,\n  isString,\n} from '@element-plus/utils'\nimport {\n  EVENT_CODE,\n  INPUT_EVENT,\n  UPDATE_MODEL_EVENT,\n} from '@element-plus/constants'\nimport ElIcon from '@element-plus/components/icon'\nimport { Plus } from '@element-plus/icons-vue'\nimport { tabsRootContextKey } from '@element-plus/tokens'\nimport { useDeprecated, useNamespace } from '@element-plus/hooks'\nimport TabNav from './tab-nav'\nimport type { TabNavInstance } from './tab-nav'\nimport type { TabsPaneContext } from '@element-plus/tokens'\n\nimport type { ExtractPropTypes } from 'vue'\nimport type { Awaitable } from '@element-plus/utils'\n\nexport type TabPanelName = string | number\n\nexport const tabsProps = buildProps({\n  type: {\n    type: String,\n    values: ['card', 'border-card', ''],\n    default: '',\n  },\n  activeName: {\n    type: [String, Number],\n    default: '',\n  },\n  closable: Boolean,\n  addable: Boolean,\n  modelValue: {\n    type: [String, Number],\n    default: '',\n  },\n  editable: Boolean,\n  tabPosition: {\n    type: String,\n    values: ['top', 'right', 'bottom', 'left'],\n    default: 'top',\n  },\n  beforeLeave: {\n    type: definePropType<\n      (\n        newName: TabPanelName,\n        oldName: TabPanelName\n      ) => Awaitable<void | boolean>\n    >(Function),\n    default: () => true,\n  },\n  stretch: Boolean,\n} as const)\nexport type TabsProps = ExtractPropTypes<typeof tabsProps>\n\nconst isPanelName = (value: unknown): value is string | number =>\n  isString(value) || isNumber(value)\n\nexport const tabsEmits = {\n  [UPDATE_MODEL_EVENT]: (name: TabPanelName) => isPanelName(name),\n  /** @deprecated use `tab-change` instead */\n  [INPUT_EVENT]: (name: TabPanelName) => isPanelName(name),\n  'tab-click': (pane: TabsPaneContext, ev: Event) => ev instanceof Event,\n  'tab-change': (name: TabPanelName) => isPanelName(name),\n  edit: (paneName: TabPanelName | undefined, action: 'remove' | 'add') =>\n    ['remove', 'add'].includes(action),\n  'tab-remove': (name: TabPanelName) => isPanelName(name),\n  'tab-add': () => true,\n}\nexport type TabsEmits = typeof tabsEmits\n\nexport default defineComponent({\n  name: 'ElTabs',\n\n  props: tabsProps,\n  emits: tabsEmits,\n\n  setup(props, { emit, slots, expose }) {\n    const instance = getCurrentInstance()!\n    const ns = useNamespace('tabs')\n\n    const nav$ = ref<TabNavInstance>()\n    const panes = reactive<Record<number, TabsPaneContext>>({})\n    const currentName = ref(props.modelValue || props.activeName || '0')\n\n    useDeprecated(\n      {\n        scope: 'el-tabs',\n        type: 'Event',\n        from: 'input',\n        replacement: 'tab-change',\n        version: '2.5.0',\n        ref: 'https://element-plus.org/en-US/component/tabs.html#tabs-events',\n      },\n      computed(() => isFunction(instance.vnode.props?.onInput))\n    )\n\n    const changeCurrentName = (value: TabPanelName) => {\n      currentName.value = value\n      /** @deprecated use `tab-change` instead */\n      emit(INPUT_EVENT, value)\n      emit(UPDATE_MODEL_EVENT, value)\n      emit('tab-change', value)\n    }\n\n    const setCurrentName = async (value: TabPanelName) => {\n      // should do nothing.\n      if (currentName.value === value) return\n\n      try {\n        const canLeave = await props.beforeLeave?.(value, currentName.value)\n        if (canLeave !== false) {\n          changeCurrentName(value)\n\n          // call exposed function, Vue doesn't support expose in typescript yet.\n          // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n          // @ts-expect-error\n          nav$.value?.removeFocus?.()\n        }\n      } catch {}\n    }\n\n    const handleTabClick = (\n      tab: TabsPaneContext,\n      tabName: TabPanelName,\n      event: Event\n    ) => {\n      if (tab.props.disabled) return\n      setCurrentName(tabName)\n      emit('tab-click', tab, event)\n    }\n\n    const handleTabRemove = (pane: TabsPaneContext, ev: Event) => {\n      if (pane.props.disabled) return\n      ev.stopPropagation()\n      emit('edit', pane.props.name, 'remove')\n      emit('tab-remove', pane.props.name)\n    }\n\n    const handleTabAdd = () => {\n      emit('edit', undefined, 'add')\n      emit('tab-add')\n    }\n\n    watch(\n      () => props.activeName,\n      (modelValue) => setCurrentName(modelValue)\n    )\n\n    watch(\n      () => props.modelValue,\n      (modelValue) => setCurrentName(modelValue)\n    )\n\n    watch(currentName, async () => {\n      // call exposed function, Vue doesn't support expose in typescript yet.\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-expect-error\n      nav$.value?.scrollToActiveTab()\n    })\n\n    {\n      const registerPane = (pane: TabsPaneContext) => (panes[pane.uid] = pane)\n      const unregisterPane = (uid: number) => delete panes[uid]\n\n      provide(tabsRootContextKey, {\n        props,\n        currentName,\n        registerPane,\n        unregisterPane,\n      })\n    }\n\n    expose({\n      currentName,\n    })\n\n    return () => {\n      const newButton =\n        props.editable || props.addable ? (\n          <span\n            class={ns.e('new-tab')}\n            tabindex=\"0\"\n            onClick={handleTabAdd}\n            onKeydown={(ev: KeyboardEvent) => {\n              if (ev.code === EVENT_CODE.enter) handleTabAdd()\n            }}\n          >\n            <ElIcon class={ns.is('icon-plus')}>\n              <Plus />\n            </ElIcon>\n          </span>\n        ) : null\n\n      const header = (\n        <div class={[ns.e('header'), ns.is(props.tabPosition)]}>\n          {newButton}\n          <TabNav\n            ref={nav$}\n            currentName={currentName.value}\n            editable={props.editable}\n            type={props.type}\n            panes={Object.values(panes)}\n            stretch={props.stretch}\n            onTabClick={handleTabClick}\n            onTabRemove={handleTabRemove}\n          />\n        </div>\n      )\n\n      const panels = (\n        <div class={ns.e('content')}>{renderSlot(slots, 'default')}</div>\n      )\n\n      return (\n        <div\n          class={[\n            ns.b(),\n            ns.m(props.tabPosition),\n            {\n              [ns.m('card')]: props.type === 'card',\n              [ns.m('border-card')]: props.type === 'border-card',\n            },\n          ]}\n        >\n          {...props.tabPosition !== 'bottom'\n            ? [header, panels]\n            : [panels, header]}\n        </div>\n      )\n    }\n  },\n})\n"],"names":["tabsProps","buildProps","type","String","values","default","activeName","Number","closable","Boolean","addable","modelValue","editable","tabPosition","beforeLeave","definePropType","Function","stretch","INPUT_EVENT","name","edit","paneName","defineComponent","props","emits","setup","getCurrentInstance","emit","useNamespace","slots","ref","expose","instance","nav$","panes","useDeprecated","scope","from","replacement","version","computed","changeCurrentName","value","currentName","canLeave","handleTabClick","tab","setCurrentName","watch","pane","disabled","ev","stopPropagation","handleTabAdd","provide","tabsRootContextKey","registerPane","uid","_createVNode","unregisterPane","EVENT_CODE","Plus","newButton","code","enter","ns","e","is"],"mappings":"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"}